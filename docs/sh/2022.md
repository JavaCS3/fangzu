# 上海

## 区域分布

```vegalite
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "房屋数量按区域分布",
  "data": {
    "url": "../../assets/data/sh/2022/rental-all-by-district.csv"
  },
  "transform": [
    {"joinaggregate": [{"op": "median", "field": "mean", "as": "median-line"}]}
  ],
  "mark": {"type": "arc", "innerRadius": 50, "tooltip": true},
  "encoding": {
    "theta": {"field": "count", "type": "quantitative", "stack": true},
    "color": {
      "field": "district",
      "type": "nominal",
      "scale": {"scheme": "tableau20"}
    },
    "order": {"field": "count", "type": "quantitative", "sort": "descending"}
  }
}
```

## 租金趋势

整租租金

```vegalite
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Stock prices of 5 Tech Companies over Time.",
  "data": {"url": "../../assets/data/sh/2022/rental-monthly-by-district.csv"},
  "height": 300,
  "mark": {"type": "line", "point": true, "tooltip": true},
  "params": [
    {
      "name": "district",
      "select": {"type": "point", "fields": ["district"]},
      "bind": "legend"
    }
  ],
  "encoding": {
    "x": {"field": "month", "type": "quantitative", "axis": {"tickMinStep": 1}},
    "y": {"field": "mean", "type": "quantitative"},
    "color": {
      "field": "district",
      "type": "nominal",
      "scale": {"scheme": "tableau20"}
    },
    "opacity": {"condition": {"param": "district", "value": 1}, "value": 0.05}
  }
}
```

每平米租金

```vegalite
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Stock prices of 5 Tech Companies over Time.",
  "data": {"url": "../../assets/data/sh/2022/rental-per-area-monthly-by-district.csv"},
  "height": 300,
  "mark": {"type": "line", "point": true, "tooltip": true},
  "params": [
    {
      "name": "district",
      "select": {"type": "point", "fields": ["district"]},
      "bind": "legend"
    }
  ],
  "encoding": {
    "x": {"field": "month", "type": "quantitative", "axis": {"tickMinStep": 1}},
    "y": {"field": "mean", "type": "quantitative"},
    "color": {
      "field": "district",
      "type": "nominal",
      "scale": {"scheme": "tableau20"}
    },
    "opacity": {"condition": {"param": "district", "value": 1}, "value": 0.05}
  }
}
```
## 排行榜

整租租金

```vegalite
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Stock prices of 5 Tech Companies over Time.",
  "data": {
    "url": "../../assets/data/sh/2022/rental-all-by-district.csv"
  },
  "height": {"step": 20},
  "transform": [
    {"joinaggregate": [{"op": "median", "field": "mean", "as": "median-line"}]}
  ],
  "layer": [
    {
      "mark": {"type": "bar", "tooltip": true},
      "encoding": {
        "y": {"field": "district", "type": "ordinal", "sort": "-x"},
        "x": {"field": "mean", "type": "quantitative"},
        "color": {
          "field": "district",
          "type": "nominal",
          "scale": {"scheme": "tableau20"}
        }
      }
    },
    {
      "mark": {"type": "rule", "color": "red", "tooltip": true},
      "encoding": {
        "x": {
          "aggregate": "median",
          "field": "median-line",
          "type": "quantitative"
        }
      }
    }
  ]
}
```

每平米租金

```vegalite
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Stock prices of 5 Tech Companies over Time.",
  "data": {
    "url": "../../assets/data/sh/2022/rental-per-area-all-by-district.csv"
  },
  "height": {"step": 20},
  "transform": [
    {"joinaggregate": [{"op": "median", "field": "mean", "as": "median-line"}]}
  ],
  "layer": [
    {
      "mark": {"type": "bar", "tooltip": true},
      "encoding": {
        "y": {"field": "district", "type": "ordinal", "sort": "-x"},
        "x": {"field": "mean", "type": "quantitative"},
        "color": {
          "field": "district",
          "type": "nominal",
          "scale": {"scheme": "tableau20"}
        }
      }
    },
    {
      "mark": {"type": "rule", "color": "red", "tooltip": true},
      "encoding": {
        "x": {
          "aggregate": "median",
          "field": "median-line",
          "type": "quantitative"
        }
      }
    }
  ]
}
```

```vegalite
{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "../../assets/data/sh/2022/rental-per-area-all-by-subdistrict.csv"
  },
  "hconcat": [
    {
      "mark": {"type": "bar", "tooltip": true},
      "transform": [{"filter": {"param": "brush"}}],
      "encoding": {
        "y": {"field": "subdistrict", "type": "ordinal", "sort": "-x"},
        "x": {"field": "mean", "type": "quantitative"},
        "tooltip": {"field": "mean", "type": "quantitative"}
      }
    },
    {
      "height": 300,
      "width": 50,
      "params": [
        {"name": "brush", "select": {"type": "interval", "encodings": ["y"]}}
      ],
      "mark": "bar",
      "encoding": {
        "y": {
          "field": "subdistrict",
          "type": "nominal",
          "sort": "-x",
          "axis": null
        },
        "x": {"field": "mean", "type": "quantitative", "axis": null}
      }
    }
  ]
}
```